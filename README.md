# Black Hole QNM Extraction using Numerical Integration

This repository contains Python code implemented in a Jupyter Notebook for simulating scalar field perturbations around a Schwarzschild black hole and extracting Quasi-Normal Modes (QNMs). The code uses a finite difference scheme for wave evolution and the Prony method for QNM analysis.

## Overview

The notebook provides a framework to study how an initial wave packet (a Gaussian pulse) scatters off the potential barrier of a Schwarzschild black hole. By observing the signal at a fixed point far from the black hole, we can analyze the characteristic "ringdown" phase, which is dominated by QNMs.

Key aspects include:
* Calculation of the Schwarzschild metric function $f(r)$.
* Robust transformation between the radial coordinate $r$ and the tortoise coordinate $r_*$ using a hybrid analytical (near-horizon) and numerical (far-field) approach with interpolation.
* Implementation of standard black hole perturbation potentials (Regge-Wheeler, Zerilli, Pöschl-Teller).
* A 2D finite difference integrator $(u, v)$ to evolve the scalar wave equation $\frac{\partial^2 \psi}{\partial u \partial v} = -V(r(x_*)) \psi$.
* Signal extraction $\psi(t)$ at a specified observer location $x^*_{\mathrm{obs}}$.
* QNM frequency extraction ($\omega = \omega_R - i \omega_I$) from the ringdown signal using the Prony method.
* Late-time tail analysis via log-log linear fitting.

## Key Features

* **Schwarzschild Spacetime:** Functions for the metric component $f(r) = 1 - 2M/r$.
* **Tortoise Coordinates:**
    * Analytical formulas for $r_*(r)$ and its inverse $r(r_*)$ using the Lambert W function.
    * A robust numerical interpolator (`make_rstar_interpolator_robust`) combining analytical near-horizon behavior with numerical integration and cubic spline interpolation for high precision, especially crucial for the finite difference scheme.
* **Perturbation Potentials:** Functions provided for:
    * Regge-Wheeler potential ($V_{RW}$)
    * Zerilli potential ($V_{ZP}$)
    * Pöschl-Teller potential ($V_{PT}$) as an analytical approximation.
* **Wave Evolution:** `wave_integrator` function evolves a scalar field $\psi(u,v)$ given an initial Gaussian profile using finite differences.
* **Signal Extraction:** `observe_signal` function extracts the time-domain signal $\psi(t)$ at a specified tortoise coordinate $x^*_{\mathrm{obs}}$.
* **QNM Analysis:** `analyze_signal` function:
    * Applies the Prony method to a specified time range (`t_fit_range`) of the signal to extract $p$ dominant QNM frequencies.
    * Fits the late-time tail (`tail_fit_range`) to a power law $\psi \sim t^{-\alpha}$.
* **Visualization:** Includes functions/code to plot:
    * Potentials $V(r)$ vs $r$ and $r_*$.
    * The relationship $r$ vs $r_*$.
    * The extracted time-domain signal $\psi(t)$.
    * The Prony fit overlaid on the ringdown signal.
    * The late-time tail fit on a log-log scale.
* **Animation:** An `animate_wave_interaction` function is included to visualize the wave scattering process and the buildup of the observer's signal over time (requires `ffmpeg`).

## Dependencies

The code requires standard scientific Python libraries:
* Python 3
* NumPy
* SciPy (specifically `interpolate`, `special`, `integrate`, `stats`)
* Matplotlib
* `warnings` (standard library)
* `ffmpeg` (optional, for saving the animation generated by `animate_wave_interaction`)

You can typically install these using pip:
```bash
pip install numpy scipy matplotlib
